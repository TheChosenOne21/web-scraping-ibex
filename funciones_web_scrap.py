import requests
from bs4 import BeautifulSoup


def extract_data (key, value):

    """se extrae A+B para cada actvo del IBEX mediante el codigo LEI y el nombre de la empresa"""

    params = (
        ('id', '7'),
    )
    cookies = {
    'tipoEnlace': 'enlaceWeb',
    'ASPSESSIONIDSARCQDRR': 'FBMHGNBCNDBLGJHOCLAJDCGC',
    'IdiomaCNMV_': 'AAEAAAD/////AQAAAAAAAAAMAgAAAEFDTk1WLkNvbXVuLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAGkNOTVYuQ29tdW4uRW50aXRpZXMuSWRpb21hBwAAAAhtX2NvZElTTwdtX29yZGVuDW1faWRpb21hQ29tdW4RbV9sZW5ndWFDb09maWNpYWwIbV9ub21icmURSWRlbnRpZnlEYXRhK21faWQVSWRlbnRpZnlEYXRhK21fbm9tYnJlAQAAAAEAAQgBAQgCAAAABgMAAAACZW4KAAAAAQAGBAAAAAdJbmdsw6lzAgAAAAkEAAAACw==',
    }

    headers = {
        'Connection': 'keep-alive',
        'Cache-Control': 'max-age=0',
        'sec-ch-ua': '"Google Chrome";v="95", "Chromium";v="95", ";Not A Brand";v="99"',
        'sec-ch-ua-mobile': '?0',
        'sec-ch-ua-platform': '"macOS"',
        'Upgrade-Insecure-Requests': '1',
        'Origin': 'https://www.cnmv.es',
        'Content-Type': 'application/x-www-form-urlencoded',
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36',
        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
        'sec-gpc': '1',
        'Sec-Fetch-Site': 'same-origin',
        'Sec-Fetch-Mode': 'navigate',
        'Sec-Fetch-User': '?1',
        'Sec-Fetch-Dest': 'document',
        'Referer': 'https://www.cnmv.es/Portal/Consultas/Busqueda.aspx?id=7',
        'Accept-Language': 'es-ES,es;q=0.9,en;q=0.8',
    }

    data = {
    '__EVENTTARGET': '',
    '__EVENTARGUMENT': '',
    '__VIEWSTATE': '/wEPDwULLTEyNzQwMzY5MjUPZBYCZg9kFgICAQ9kFhgCCg9kFgICAQ8PFgIeC05hdmlnYXRlVXJsBT9odHRwczovL3d3dy5jbm12LmVzL1BvcnRhbC9Db25zdWx0YXMvQnVzcXVlZGEuYXNweD9pZD03Jmxhbmc9ZW5kZAILDxYCHgdWaXNpYmxlZxYCAgEPDxYIHgRfIVNCAgIeC21fc3BhbkNsYXNzBRJpY29uLWludGVybmFjaW9uYWweCENzc0NsYXNzBQ5idG5fSWRpb21hX2JpZx8ABT9odHRwczovL3d3dy5jbm12LmVzL1BvcnRhbC9Db25zdWx0YXMvQnVzcXVlZGEuYXNweD9pZD03Jmxhbmc9ZXNkZAIMDxYCHwFnFgICAQ8PFgYfBAUQaWRpb21hIHNpbmJvcmRlcx8ABT9odHRwczovL3d3dy5jbm12LmVzL1BvcnRhbC9Db25zdWx0YXMvQnVzcXVlZGEuYXNweD9pZD03Jmxhbmc9Z2wfAgICZGQCDQ8WAh8BZxYCAgEPDxYCHwAFP2h0dHBzOi8vd3d3LmNubXYuZXMvUG9ydGFsL0NvbnN1bHRhcy9CdXNxdWVkYS5hc3B4P2lkPTcmbGFuZz1ldWRkAg4PFgIfAWcWAgIBDw8WAh8ABT9odHRwczovL3d3dy5jbm12LmVzL1BvcnRhbC9Db25zdWx0YXMvQnVzcXVlZGEuYXNweD9pZD03Jmxhbmc9Y2FkZAIPDxYCHgtfIUl0ZW1Db3VudAIKFhQCAQ9kFgpmDxUBBDxsaT5kAgEPDxYIHgRUZXh0BQRIb21lHwAFC34vaG9tZS5hc3B4HgZUYXJnZXQFBF90b3AeB1Rvb2xUaXAFCkdvIHRvIEhvbWVkZAIDDw8WBB8IBRFEaXNwbGF5IG1lbnUgSG9tZR8BaGQWAmYPDxYCHg1BbHRlcm5hdGVUZXh0BRhpbWFnZW4gRGlzcGxheSBtZW51IEhvbWVkZAIFDw8WAh8BaGRkAgcPFgQfBWYfAWhkAgIPZBYIZg8VARw8bGkgY2xhc3M9ImluaXQtYXJyb3ctZG93biI+ZAIBDw8WDB8GBQpBYm91dCBDTk1WHwAFFn4vTWVudS9Tb2JyZS1DTk1WLmFzcHgfBwUEX3RvcB8IBRBHbyB0byBBYm91dCBDTk1WHwQFCHR4dF9NZW51HwICAmRkAgMPDxYCHwgFF0Rpc3BsYXkgbWVudSBBYm91dCBDTk1WZBYCZg8PFgIfCQUeaW1hZ2VuIERpc3BsYXkgbWVudSBBYm91dCBDTk1WZGQCBw8WAh8FAg0WGgIBD2QWAgIBDw8WBh8ABSB+L3F1ZWVzL0Z1bmNpb25lcy9GdW5jaW9uZXMuYXNweB8HBQVfc2VsZh8IBRVHbyB0byBDTk1WIGZ1bmN0aW9ucyBkFgJmDxUBD0NOTVYgZnVuY3Rpb25zIGQCAg9kFgICAQ8PFgYfAAUefi9HUGFnZS5hc3B4P2lkPU9yZ2FuaWdyYW1hX0FBHwcFBF90b3AfCAUjR28gdG8gQ05NViBPcmdhbml6YXRpb25hbCBzdHJ1Y3R1cmVkFgJmDxUBGE9yZ2FuaXphdGlvbmFsIHN0cnVjdHVyZWQCAw9kFgICAQ8PFgYfAAUefi9xdWVlcy9Db21pdGUtQ29uc3VsdGl2by5hc3B4HwcFBF90b3AfCAUYR28gdG8gQWR2aXNvcnkgQ29tbWl0dGVlZBYCZg8VARJBZHZpc29yeSBDb21taXR0ZWVkAgQPZBYCAgEPDxYGHwAFHH4vcXVlZXMvUmVnaW1lbkludGVyaW9yLmFzcHgfBwUEX3RvcB8IBRVHbyB0byBJbnRlcm5hbCByZWdpbWVkFgJmDxUBD0ludGVybmFsIHJlZ2ltZWQCBQ9kFgICAQ8PFgYfAAUdL0RvY1BvcnRhbC9xdWVlcy9Db25kdWN0YS5wZGYfBwUGX2JsYW5rHwgFKEdvIHRvIENvZGUgb2YgY29uZHVjdCAocGRmLCBvcGVuIHdpbmRvdylkFgJmDxUBD0NvZGUgb2YgY29uZHVjdGQCBg9kFgICAQ8PFgYfAAUkfi9xdWVlcy9wcm9jZWRpbWllbnRvcy1pbnRlcm5vcy5hc3B4HwcFBV9zZWxmHwgFGUdvIHRvIEludGVybmFsIHByb2NlZHVyZXNkFgJmDxUBE0ludGVybmFsIHByb2NlZHVyZXNkAgcPZBYCAgEPDxYGHwAFH34vcXVlZXMvSW5mb21lcy1Tb2JyZS1DTk1WLmFzcHgfBwUEX3RvcB8IBRJHbyB0byBDTk1WIHJlcG9ydHNkFgJmDxUBDENOTVYgcmVwb3J0c2QCCA9kFgICAQ8PFgYfAAUbfi9xdWVlcy9PZmVydGFzL2VtcGxlby5hc3B4HwcFBF90b3AfCAUTR28gdG8gSm9iIHZhY2FuY2llc2QWAmYPFQENSm9iIHZhY2FuY2llc2QCCQ9kFgICAQ8PFgYfAAUtfi9xdWVlcy9pbmZvcm1hY2lvbi1lY29ub21pY2EtZmluYW5jaWVyYS5hc3B4HwcFBF90b3AfCAUmR28gdG8gRWNvbm9taWMgLSBmaW5hbmNpYWwgaW5mb3JtYXRpb25kFgJmDxUBIEVjb25vbWljIC0gZmluYW5jaWFsIGluZm9ybWF0aW9uZAIKD2QWAgIBDw8WBh8ABR1+L3F1ZWVzL3BsYW4tYWN0aXZpZGFkZXMuYXNweB8HBQRfdG9wHwgFE0dvIHRvIEFjdGl2aXR5IFBsYW5kFgJmDxUBDUFjdGl2aXR5IFBsYW5kAgsPZBYCAgEPDxYGHwAFGX4vcXVlZXMvTGljaXRhY2lvbmVzLmFzcHgfBwUEX3RvcB8IBSBHbyB0byBJbnN0aXR1dGlvbmFsIHByb2N1cmVtZW50c2QWAmYPFQEaSW5zdGl0dXRpb25hbCBwcm9jdXJlbWVudHNkAgwPZBYCAgEPDxYGHwAFHH4vcXVlZXMvVGFzYXMvUGFnb1Rhc2FzLmFzcHgfBwUEX3RvcB8IBQ9HbyB0byBDTk1WIEZlZXNkFgJmDxUBCUNOTVYgRmVlc2QCDQ9kFgICAQ8PFgYfAAUefi9xdWVlcy9MZXktVHJhbnNwYXJlbmNpYS5hc3B4HwcFBF90b3AfCAUWR28gdG8gVHJhbnNwYXJlbmN5IGFjdGQWAmYPFQEQVHJhbnNwYXJlbmN5IGFjdGQCAw9kFghmDxUBHDxsaSBjbGFzcz0iaW5pdC1hcnJvdy1kb3duIj5kAgEPDxYMHwYFClByZXNzIHJvb20fAAUTfi9BbERpYS9NZWRpb3MuYXNweB8HBQRfdG9wHwgFEEdvIHRvIFByZXNzIHJvb20fBAUIdHh0X01lbnUfAgICZGQCAw8PFgIfCAUXRGlzcGxheSBtZW51IFByZXNzIHJvb21kFgJmDw8WAh8JBR5pbWFnZW4gRGlzcGxheSBtZW51IFByZXNzIHJvb21kZAIHDxYCHwUCBRYKAgEPZBYCAgEPDxYGHwAFGX4vQWxEaWEvTm90YXMtUHJlbnNhLmFzcHgfBwUEX3RvcB8IBRlHbyB0byBDTk1WIHByZXNzIHJlbGVhc2VzZBYCZg8VAQ9QcmVzcyByZWxlYXNlcyBkAgIPZBYCAgEPDxYGHwAFH34vQWxEaWEvSW5mb3JtYWNpb24tU2VjdG9yLmFzcHgfBwUEX3RvcB8IBShHbyB0byBJbmZvcm1hdGlvbiBmb3IgcmVndWxhdGVkIGVudGl0aWVzZBYCZg8VASJJbmZvcm1hdGlvbiBmb3IgcmVndWxhdGVkIGVudGl0aWVzZAIDD2QWAgIBDw8WBh8ABR1+L0FsRGlhL0luZGljZS1EaXNjdXJzb3MuYXNweB8HBQRfdG9wHwgFG0dvIHRvIFNwZWVjaGVzIGFuZCBhcnRpY2xlc2QWAmYPFQEVU3BlZWNoZXMgYW5kIGFydGljbGVzZAIED2QWAgIBDw8WBh8ABSB+L0FsRGlhL0dhbGVyaWEtTXVsdGltZWRpYS5hc3B4IB8HBQRfdG9wHwgFGEdvIHRvIE11bHRpbWVkaWEgZ2FsbGVyeWQWAmYPFQESTXVsdGltZWRpYSBnYWxsZXJ5ZAIFD2QWAgIBDw8WBh8ABR5+L0FsRGlhL1ByZW1pby1QZXJpb2Rpc21vLmFzcHgfBwUEX3RvcB8IBSxHbyB0byBBbnRvbmlvIE1vcmVubyBFc3Blam8gSm91cm5hbGlzbSBBd2FyZGQWAmYPFQEmQW50b25pbyBNb3Jlbm8gRXNwZWpvIEpvdXJuYWxpc20gQXdhcmRkAgQPZBYKZg8VAQQ8bGk+ZAIBDw8WCB8GBRFQdWJsaWMgU3RhdGVtZW50cx8ABSR+L0FsRGlhL0NvbXVuaWNhY2lvbmVzLVB1YmxpY2FzLmFzcHgfBwUEX3RvcB8IBRdHbyB0byBQdWJsaWMgU3RhdGVtZW50c2RkAgMPDxYEHwgFHkRpc3BsYXkgbWVudSBQdWJsaWMgU3RhdGVtZW50cx8BaGQWAmYPDxYCHwkFJWltYWdlbiBEaXNwbGF5IG1lbnUgUHVibGljIFN0YXRlbWVudHNkZAIFDw8WAh8BaGRkAgcPFgQfBWYfAWhkAgUPZBYKZg8VAQQ8bGk+ZAIBDw8WCB8GBRJJbnNpZGUgaW5mb3JtYXRpb24fAAUrfi9JbmZvcm1hY2lvbi1Qcml2aWxlZ2lhZGEvQ29uc3VsdGEtSVAuYXNweB8HBQRfdG9wHwgFGEdvIHRvIEluc2lkZSBpbmZvcm1hdGlvbmRkAgMPDxYEHwgFH0Rpc3BsYXkgbWVudSBJbnNpZGUgaW5mb3JtYXRpb24fAWhkFgJmDw8WAh8JBSZpbWFnZW4gRGlzcGxheSBtZW51IEluc2lkZSBpbmZvcm1hdGlvbmRkAgUPDxYCHwFoZGQCBw8WBB8FZh8BaGQCBg9kFgpmDxUBBDxsaT5kAgEPDxYIHwYFOVJlbGV2YW50IGluZm9ybWF0aW9uIG9uIENJUyBhbmQgb3RoZXIgYXV0aG9yaXNlZCBlbnRpdGllcx8ABR9+L2hyL2J1c3F1ZWRhaHIuYXNweD9kaXZpc2lvbj0yHwcFBF90b3AfCAU/R28gdG8gUmVsZXZhbnQgaW5mb3JtYXRpb24gb24gQ0lTIGFuZCBvdGhlciBhdXRob3Jpc2VkIGVudGl0aWVzZGQCAw8PFgQfCAVGRGlzcGxheSBtZW51IFJlbGV2YW50IGluZm9ybWF0aW9uIG9uIENJUyBhbmQgb3RoZXIgYXV0aG9yaXNlZCBlbnRpdGllcx8BaGQWAmYPDxYCHwkFTWltYWdlbiBEaXNwbGF5IG1lbnUgUmVsZXZhbnQgaW5mb3JtYXRpb24gb24gQ0lTIGFuZCBvdGhlciBhdXRob3Jpc2VkIGVudGl0aWVzZGQCBQ8PFgIfAWhkZAIHDxYEHwVmHwFoZAIHD2QWCGYPFQEcPGxpIGNsYXNzPSJpbml0LWFycm93LWRvd24iPmQCAQ8PFgwfBgUSUmVnaXN0cmF0aW9uIGZpbGVzHwAFH34vTWVudS9SZWdpc3Ryb3MtT2ZpY2lhbGVzLmFzcHgfBwUEX3RvcB8IBRhHbyB0byBSZWdpc3RyYXRpb24gZmlsZXMfBAUIdHh0X01lbnUfAgICZGQCAw8PFgIfCAUfRGlzcGxheSBtZW51IFJlZ2lzdHJhdGlvbiBmaWxlc2QWAmYPDxYCHwkFJmltYWdlbiBEaXNwbGF5IG1lbnUgUmVnaXN0cmF0aW9uIGZpbGVzZGQCBw8WAh8FAg4WHAIBD2QWAgIBDw8WBh8ABSN+L0NvbnN1bHRhcy9CdXNxdWVkYVBvckVudGlkYWQuYXNweB8HBQRfdG9wHwgFI0dvIHRvIENvbXBhbmllcyBzZWFyY2gsIGJ5IGVudGl0aWVzZBYCZg8VARBDb21wYW5pZXMgU2VhcmNoZAICD2QWAgIBDw8WBh8ABRp+L0NvbnN1bHRhcy9JbmRpY2VFQU8uYXNweB8HBQRfdG9wHwgFJ0dvIHRvIElzc3VlcywgdHJhZGluZyBhbmQgVGFrZW92ZXIgQmlkc2QWAmYPFQEhSXNzdWVzLCB0cmFkaW5nIGFuZCBUYWtlb3ZlciBCaWRzZAIDD2QWAgIBDw8WBh8ABRp+L0NvbnN1bHRhcy9JbmRpY2VFU0kuYXNweB8HBQRfdG9wHwgFFkdvIHRvIEludmVzdG1lbnQgRmlybXNkFgJmDxUBEEludmVzdG1lbnQgRmlybXNkAgQPZBYCAgEPDxYGHwAFGn4vQ29uc3VsdGFzL0luZGljZUlJQy5hc3B4HwcFBF90b3AfCAUjR28gdG8gQ29sbGVjdGl2ZSBJbnZlc3RtZW50IFNjaGVtZXNkFgJmDxUBHUNvbGxlY3RpdmUgSW52ZXN0bWVudCBTY2hlbWVzZAIFD2QWAgIBDw8WBh8ABTB+L0NvbnN1bHRhcy9WZWhpY3Vsb3MtSW52ZXJzaW9uLUV4dHJhbmplcm9zLmFzcHgfBwUEX3RvcB8IBSFHbyB0byBGb3JlaWduIGludmVzdG1lbnQgdmVoaWNsZXNkFgJmDxUBG0ZvcmVpZ24gaW52ZXN0bWVudCB2ZWhpY2xlc2QCBg9kFgICAQ8PFgYfAAUafi9Db25zdWx0YXMvSW5kaWNlRUlSLmFzcHgfBwUEX3RvcB8IBShHbyB0byBTZWUgb3RoZXIgaW5mb3JtYXRpb24gZnJvbSBpc3N1ZXJzZBYCZg8VATdJc3N1ZXJzIEZpbGluZ3M6IEluZm9ybWF0aW9uIHVuZGVyIHJlZ3VsYXRpb24gYW5kIG90aGVyZAIHD2QWAgIBDw8WBh8ABRp+L0NvbnN1bHRhcy9JbmRpY2VFQ1IuYXNweB8HBQRfdG9wHwgFH0dvIHRvIFZlbnR1cmUgQ2FwaXRhbCBDb21wYW5pZXNkFgJmDxUBGVZlbnR1cmUgQ2FwaXRhbCBDb21wYW5pZXNkAggPZBYCAgEPDxYGHwAFHH4vR1BhZ2UuYXNweD9pZD1Db25zdWx0YXNfSU0fBwUEX3RvcB8IBRdHbyB0byBSZWd1bGF0ZWQgTWFya2V0c2QWAmYPFQERUmVndWxhdGVkIE1hcmtldHNkAgkPZBYCAgEPDxYGHwAFIH4vUHVibGljYWNpb25lcy9DTk1WSW5mb3JtYS5hc3B4HwcFBF90b3AfCAUfR28gdG8gV2Vla2x5IHJlZ2lzdHJhdGlvbiBmaWxlc2QWAmYPFQEZV2Vla2x5IHJlZ2lzdHJhdGlvbiBmaWxlc2QCCg9kFgICAQ8PFgYfAAUjfi9Db25zdWx0YXMvTGlzdGFkb0FnZW5jaWFzQ1JBLmFzcHgfBwUEX3RvcB8IBRxHbyB0byBDcmVkaXQgcmF0aW5nIGFnZW5jaWVzZBYCZg8VARZDcmVkaXQgcmF0aW5nIGFnZW5jaWVzZAILD2QWAgIBDw8WBh8ABTJ+L0NvbnN1bHRhcy9SZWdpc3Ryb1NhbmNpb25lcy9JbmlSZWdTYW5jaW9uZXMuYXNweB8HBQRfdG9wHwgFHEdvIHRvIERpc2NpcGxpbmFyeSBwZW5hbHRpZXNkFgJmDxUBFkRpc2NpcGxpbmFyeSBwZW5hbHRpZXNkAgwPZBYCAgEPDxYGHwAFPn4vQ29uc3VsdGFzL1BsYXRhZm9ybWEvRmluYW5jaWFjaW9uLVBhcnRpY2lwYXRpdmEtTGlzdGFkby5hc3B4HwcFBF90b3AfCAUcR28gdG8gQ3Jvd2RmdW5kaW5nIFBsYXRmb3Jtc2QWAmYPFQEWQ3Jvd2RmdW5kaW5nIFBsYXRmb3Jtc2QCDQ9kFgICAQ8PFgYfAAUmfi9Db25zdWx0YXMvTW9zdHJhckxpc3RhZG9zLmFzcHg/aWQ9MjUfBwUEX3RvcB8IBTRHbyB0byBFbnRpdGllcyB0aGF0IGNhcnJ5IG91dCB0aGUgdmFsdWF0aW9uIGZ1bmN0aW9uZBYCZg8VAS5FbnRpdGllcyB0aGF0IGNhcnJ5IG91dCB0aGUgdmFsdWF0aW9uIGZ1bmN0aW9uZAIOD2QWAgIBDw8WBh8ABSJ+L0NvbnN1bHRhcy9Qcm92ZWVkb3Jlcy1EYXRvcy5hc3B4HwcFBF90b3AfCAUnR28gdG8gRGF0YSByZXBvcnRpbmcgc2VydmljZXMgcHJvdmlkZXJzZBYCZg8VASFEYXRhIHJlcG9ydGluZyBzZXJ2aWNlcyBwcm92aWRlcnNkAggPZBYKZg8VAQQ8bGk+ZAIBDw8WCB8GBQxQcm9zcGVjdHVzZXMfAAUjfi9Gb2xsZXRvcy1SZWdpc3Ryb3MtT2ZpY2lhbGVzLmFzcHgfBwUEX3RvcB8IBRJHbyB0byBQcm9zcGVjdHVzZXNkZAIDDw8WBB8IBRlEaXNwbGF5IG1lbnUgUHJvc3BlY3R1c2VzHwFoZBYCZg8PFgIfCQUgaW1hZ2VuIERpc3BsYXkgbWVudSBQcm9zcGVjdHVzZXNkZAIFDw8WAh8BaGRkAgcPFgQfBWYfAWhkAgkPZBYIZg8VARw8bGkgY2xhc3M9ImluaXQtYXJyb3ctZG93biI+ZAIBDw8WDB8GBSFJbnZlc3RvcnMgYW5kIGZpbmFuY2lhbCBlZHVjYXRpb24fAAUWfi9JbnZlcnNvci9JbmRpY2UuYXNweB8HBQRfdG9wHwgFJ0dvIHRvIEludmVzdG9ycyBhbmQgZmluYW5jaWFsIGVkdWNhdGlvbh8EBQh0eHRfTWVudR8CAgJkZAIDDw8WAh8IBS5EaXNwbGF5IG1lbnUgSW52ZXN0b3JzIGFuZCBmaW5hbmNpYWwgZWR1Y2F0aW9uZBYCZg8PFgIfCQU1aW1hZ2VuIERpc3BsYXkgbWVudSBJbnZlc3RvcnMgYW5kIGZpbmFuY2lhbCBlZHVjYXRpb25kZAIHDxYCHwUCDBYYAgEPZBYCAgEPDxYGHwAFGX4vSW52ZXJzb3IvTm90aWNpYXMuYXNweCAfBwUEX3RvcB8IBRFHbyB0byBMYXRlc3QgbmV3c2QWAmYPFQELTGF0ZXN0IG5ld3NkAgIPZBYCAgEPDxYGHwAFI34vSW52ZXJzb3IvSW5mb3JtYWNpb24tSW50ZXJlcy5hc3B4HwcFBF90b3AfCAUuR28gdG8gSW5mb3JtYXRpb24gb2YgaW50ZXJlc3QgZm9yIHRoZSBpbnZlc3RvcmQWAmYPFQEoSW5mb3JtYXRpb24gb2YgaW50ZXJlc3QgZm9yIHRoZSBpbnZlc3RvcmQCAw9kFgICAQ8PFgYfAAUTfi9BZHZlcnRlbmNpYXMuYXNweB8HBQRfdG9wHwgFNkdvIHRvIFdhcm5pbmdzICh1bmF1dGhvcmlzZWQgZmlybXMgYW5kIG90aGVyIGVudGl0aWVzKWQWAmYPFQEwV2FybmluZ3MgKHVuYXV0aG9yaXNlZCBmaXJtcyBhbmQgb3RoZXIgZW50aXRpZXMpZAIED2QWAgIBDw8WBh8ABSB+L0dwYWdlLmFzcHg/aWQ9QWxlcnRhcy1JbnZlcnNvch8HBQRfdG9wHwgFHEdvIHRvIFdhcm5pbmdzIGZvciBpbnZlc3RvcnNkFgJmDxUBFldhcm5pbmdzIGZvciBpbnZlc3RvcnNkAgUPZBYCAgEPDxYGHwAFHn4vaW52ZXJzb3IvUmVjbGFtYWNpb25lcy5hc3B4IB8HBQRfdG9wHwgFEEdvIHRvIENvbXBsYWludHNkFgJmDxUBCkNvbXBsYWludHNkAgYPZBYCAgEPDxYGHwAFGn4vaW52ZXJzb3IvQ29uc3VsdGFzLmFzcHggHwcFBF90b3AfCAUPR28gdG8gRW5xdWlyaWVzZBYCZg8VAQlFbnF1aXJpZXNkAgcPZBYCAgEPDxYGHwAFHH4vaW52ZXJzb3IvRmljaGFzLUd1aWFzLmFzcHgfBwUEX3RvcB8IBSBHbyB0byBGaW5hbmNpYWwgZWR1Y2F0aW9uIGd1aWRlc2QWAmYPFQEaRmluYW5jaWFsIGVkdWNhdGlvbiBndWlkZXNkAggPZBYCAgEPDxYGHwAFGn4vaW52ZXJzb3IvTXVsdGltZWRpYS5hc3B4HwcFBF90b3AfCAUKTXVsdGltZWRpYWQWAmYPFQEKTXVsdGltZWRpYWQCCQ9kFgICAQ8PFgYfAAUmfi9pbnZlcnNvci9EZWNhbG9nby1jaGlyaW5ndWl0b3MuYXNweCAfBwUEX3RvcB8IBS5HbyB0byBUZW4gdGlwcyB0byBhdm9pZCBmaW5hbmNpYWwgYm9pbGVyIHJvb21zZBYCZg8VAShUZW4gdGlwcyB0byBhdm9pZCBmaW5hbmNpYWwgYm9pbGVyIHJvb21zZAIKD2QWAgIBDw8WBh8ABRt+L2ludmVyc29yL09yaWVudGFjaW9uLmFzcHgfBwUEX3RvcB8IBRdHbyB0byBJbnZlc3RvciBndWlkYW5jZWQWAmYPFQERSW52ZXN0b3IgZ3VpZGFuY2VkAgsPZBYCAgEPDxYGHwAFH34vaW52ZXJzb3IvR2xvc2FyaW8tSW5kaWNlLmFzcHgfBwUEX3RvcB8IBQ5HbyB0byBHbG9zc2FyeWQWAmYPFQEIR2xvc3NhcnlkAgwPZBYCAgEPDxYGHwAFHn4vaW52ZXJzb3IvUGxhbi1FZHVjYWNpb24uYXNweB8HBQRfdG9wHwgFHkdvIHRvIEZpbmFuY2lhbCBFZHVjYXRpb24gUGxhbmQWAmYPFQEYRmluYW5jaWFsIEVkdWNhdGlvbiBQbGFuZAIKD2QWCGYPFQEcPGxpIGNsYXNzPSJpbml0LWFycm93LWRvd24iPmQCAQ8PFgwfBgUrTGVnaXNsYXRpb24sIFB1YmxpY2F0aW9ucyBhbmQgb3RoZXIgY29udGVudB8ABSF+L090cm9zLUNvbnRlbmlkb3MtQ05NVi5hc3B4ICAgICAfBwUEX3RvcB8IBTFHbyB0byBMZWdpc2xhdGlvbiwgUHVibGljYXRpb25zIGFuZCBvdGhlciBjb250ZW50HwQFCHR4dF9NZW51HwICAmRkAgMPDxYCHwgFOERpc3BsYXkgbWVudSBMZWdpc2xhdGlvbiwgUHVibGljYXRpb25zIGFuZCBvdGhlciBjb250ZW50ZBYCZg8PFgIfCQU/aW1hZ2VuIERpc3BsYXkgbWVudSBMZWdpc2xhdGlvbiwgUHVibGljYXRpb25zIGFuZCBvdGhlciBjb250ZW50ZGQCBw8WAh8FAgsWFgIBD2QWAgIBDw8WBh8ABRd+L01lbnUvTGVnaXNsYWNpb24uYXNweB8HBQRfdG9wHwgFEUdvIHRvIExlZ2lzbGF0aW9uZBYCZg8VAQtMZWdpc2xhdGlvbmQCAg9kFgICAQ8PFgYfAAU0fi9NZW51L1B1YmxpY2FjaW9uZXMtRXN0YWRpc3RpY2FzLUludmVzdGlnYWNpb24uYXNweB8HBQRfdG9wHwgFK0dvIHRvIFB1YmxpY2F0aW9ucywgU3RhdGlzdGljcyBhbmQgUmVzZWFyY2hkFgJmDxUBJVB1YmxpY2F0aW9ucywgU3RhdGlzdGljcyBhbmQgUmVzZWFyY2hkAgMPZBYCAgEPDxYGHwAFGH4vSW5kaWNlUGVyZmlsLmFzcHg/aWQ9Mh8HBQRfdG9wHwgFIkdvIHRvIElzc3VlcnMgYW5kIGxpc3RlZCBjb21wYW5pZXNkFgJmDxUBHElzc3VlcnMgYW5kIGxpc3RlZCBjb21wYW5pZXNkAgQPZBYCAgEPDxYGHwAFGH4vSW5kaWNlUGVyZmlsLmFzcHg/aWQ9Mx8HBQRfdG9wHwgFL0dvIHRvIENvbGxlY3RpdmUgSW52ZXN0bWVudCBhbmQgVmVudHVyZSBDYXBpdGFsZBYCZg8VASlDb2xsZWN0aXZlIEludmVzdG1lbnQgYW5kIFZlbnR1cmUgQ2FwaXRhbGQCBQ9kFgICAQ8PFgYfAAUYfi9JbmRpY2VQZXJmaWwuYXNweD9pZD01HwcFBF90b3AfCAUWR28gdG8gSW52ZXN0bWVudCBGaXJtc2QWAmYPFQEQSW52ZXN0bWVudCBGaXJtc2QCBg9kFgICAQ8PFgYfAAUYfi9JbmRpY2VQZXJmaWwuYXNweD9pZD02HwcFBF90b3AfCAUcR28gdG8gTWFya2V0IGluZnJhc3RydWN0dXJlc2QWAmYPFQEWTWFya2V0IGluZnJhc3RydWN0dXJlc2QCBw9kFgICAQ8PFgYfAAUmfi9DU0QvRGVwb3NpdGFyaW8tQ2VudHJhbC1WYWxvcmVzLmFzcHgfBwUEX3RvcB8IBSVHbyB0byBDZW50cmFsIFNlY3VyaXRpZXMgRGVwb3NpdG9yaWVzZBYCZg8VASQgICAgQ2VudHJhbCBTZWN1cml0aWVzIERlcG9zaXRvcmllcyBkAggPZBYCAgEPDxYGHwAFHn4vTWlGSURJSV9NaUZJUi9NYXBhTWlGSUQuYXNweB8HBQRfdG9wHwgFFkdvIHRvIE1pRklEIElJIC0gTWlGSVJkFgJmDxUBEE1pRklEIElJIC0gTWlGSVJkAgkPZBYCAgEPDxYGHwAFMH4vQWxkaWEvQWN0SW50ZXJuYWNpb25hbC9BY3RJbnRlcm5hY2lvbmFsZXMuYXNweB8HBQRfdG9wHwgFHkdvIHRvIEludGVybmF0aW9uYWwgYWN0aXZpdGllc2QWAmYPFQEYSW50ZXJuYXRpb25hbCBhY3Rpdml0aWVzZAIKD2QWAgIBDw8WBh8ABRp+L1RpdHVsb3MtQWNyZWRpdGFkb3MuYXNweB8HBQRfdG9wHwgFTEdvIHRvIFF1YWxpZmljYXRpb25zIGZvciB0aGUgVHJhaW5pbmcgb2Ygc3RhZmYgb2YgZW50aXRpZXPigJkgc2FsZXMgbmV0d29ya3NkFgJmDxUBR1F1YWxpZmljYXRpb25zIGZvciB0aGUgVHJhaW5pbmcgb2Ygc3RhZmYgb2YgZW50aXRpZXPigJkgc2FsZXMgbmV0d29ya3MgZAILD2QWAgIBDw8WBh8ABSN+L0JlbmNobWFyay9JbmRpY2VzLVJlZmVyZW5jaWEuYXNweB8HBQRfdG9wHwgFEEdvIHRvIEJlbmNobWFya3NkFgJmDxUBCkJlbmNobWFya3NkAhsPZBYCZg8WAh8FAgkWEgIBD2QWBGYPFQECZW5kAgEPDxYKHwgFEUZpbGluZyBjb21wbGFpbnRzHwQFCGxhcmdlVGFnHwYFEUZpbGluZyBjb21wbGFpbnRzHwAFPmh0dHBzOi8vd3d3LmNubXYuZXMvUG9ydGFsL2ludmVyc29yL0NvbW8tUmVjbGFtYXIuYXNweD9sYW5nPWVuHwICAmRkAgIPZBYEZg8VAQJlbmQCAQ8PFgofCAUIQ292aWQtMTkfBAUIc21hbGxUYWcfBgUIQ292aWQtMTkfAAU3aHR0cDovL3d3dy5jbm12LmVzL1BvcnRhbC9ncGFnZS5hc3B4P2lkPUNPVklEMTkmbGFuZz1lbh8CAgJkZAIDD2QWBGYPFQECZXNkAgEPDxYKHwgFCFdhcm5pbmdzHwQFCW1lZGl1bVRhZx8GBQhXYXJuaW5ncx8ABS9odHRwOi8vY25tdi5lcy9wb3J0YWwvQWR2ZXJ0ZW5jaWFzLmFzcHg/bGFuZz1lbh8CAgJkZAIED2QWBGYPFQECZW5kAgEPDxYKHwgFDlN1c3RhaW5hYmlsaXR5HwQFCW1lZGl1bVRhZx8GBQ5TdXN0YWluYWJpbGl0eR8ABUJodHRwOi8vd3d3LmNubXYuZXMvUG9ydGFsL0ZpbmFuemFzLVNvc3RlbmlibGVzL0luZGljZS5hc3B4P2xhbmc9ZW4fAgICZGQCBQ9kFgRmDxUBAmVuZAIBDw8WCh8IBRBNaUZJRCBJSSAtIE1pRklSHwQFCHNtYWxsVGFnHwYFEE1pRklEIElJIC0gTWlGSVIfAAUyaHR0cDovL2NubXYuZXMvcG9ydGFsL01pRklESUlfTWlGSVIvTWFwYU1pRklELmFzcHgfAgICZGQCBg9kFgRmDxUBAmVuZAIBDw8WCh8IBRNGaW5hbmNpYWwgRWR1Y2F0aW9uHwQFCGxhcmdlVGFnHwYFE0ZpbmFuY2lhbCBFZHVjYXRpb24fAAU0aHR0cDovL3d3dy5jbm12LmVzL1BvcnRhbC9pbnZlcnNvci9GaWNoYXMtR3VpYXMuYXNweB8CAgJkZAIHD2QWBGYPFQECZW5kAgEPDxYKHwgFCUVucXVpcmllcx8EBQhzbWFsbFRhZx8GBQlFbnF1aXJpZXMfAAU6aHR0cDovL2NubXYuZXMvUG9ydGFsL2ludmVyc29yL0NvbW8tQ29uc3VsdGFyLmFzcHg/bGFuZz1lbh8CAgJkZAIID2QWBGYPFQECZXNkAgEPDxYKHwgFEFRlY2huaWNhbCBndWlkZXMfBAUJbWVkaXVtVGFnHwYFEFRlY2huaWNhbCBndWlkZXMfAAU5aHR0cDovL3d3dy5jbm12LmVzL1BvcnRhbC9MZWdpc2xhY2lvbi9HdWlhcy1UZWNuaWNhcy5hc3B4HwICAmRkAgkPZBYEZg8VAQJlc2QCAQ8PFgofCAUHRmluVGVjaB8EBQhsYXJnZVRhZx8GBQdGaW5UZWNoHwAFMWh0dHA6Ly93d3cuY25tdi5lcy9wb3J0YWwvRmludGVjaC9Jbm5vdmFjaW9uLmFzcHgfAgICZGQCHw9kFgJmDw9kFgYeBHJvbGUFBmJ1dHRvbh4Hb25jbGljawWVAWphdmFzY3JpcHQ6V2ViRm9ybV9Eb1Bvc3RCYWNrV2l0aE9wdGlvbnMobmV3IFdlYkZvcm1fUG9zdEJhY2tPcHRpb25zKCJjdGwwMCR3QnVzcXVlZGEkYnRuQnVzY2FyIiwgIiIsIHRydWUsICJCdXNjYWRvclR1dG9yaXphZG8iLCAiIiwgZmFsc2UsIGZhbHNlKSk7Hgh0YWJpbmRleAUBMBYCAgIPD2QWBh4LcGxhY2Vob2xkZXIFBlNlYXJjaB4Hb25mb2N1cwUTdGhpcy5wbGFjZWhvbGRlcj0nJx4Gb25ibHVyBRN0aGlzLnBsYWNlaG9sZGVyPScnZAIgDxYEHwVmHwFoZAIhDw9kFgIeBWNsYXNzBQpiYW5uZXItdG9wFgQCAQ9kFgICAQ8WAh4JaW5uZXJodG1sBStTaWduaWZpY2FudCBIb2xkaW5ncyBhbmQgQm91Z2h0LUJhY2sgU2hhcmVzZAIDDw8WCB8IBStTaWduaWZpY2FudCBIb2xkaW5ncyBhbmQgQm91Z2h0LUJhY2sgU2hhcmVzHwkFK1NpZ25pZmljYW50IEhvbGRpbmdzIGFuZCBCb3VnaHQtQmFjayBTaGFyZXMeCEltYWdlVXJsBR9+L2ltYWdlcy9iYW5uZXItdG9wLWdyYWZpY2EuanBnHwFnZGQCIw8WAh8BaGQCJQ9kFg4CBQ9kFgJmD2QWAgIDDxBkZBYAZAIHDw8WAh8BZ2QWAgIDDw9kFgIfDQURT3JnYW5pc2F0aW9uIG5hbWVkAgkPZBYCAgMPD2QWAh8NBQhMRUkgY29kZWQCCw9kFgICAw8QZGQWAGQCDQ8PFgIfAWdkFggCAQ8PFgIfBgUpU2VhcmNoIGJ5IGludGVydmFsIG9mIGRhdGVzIChkZC1tbS15eXl5KTpkZAIFDw8WAh4IVGFiSW5kZXgBmgFkZAILDw8WAh8TAZ8BZGQCDw9kFgQCAQ8PFgIfBgUmQnkgZmlsaW5ncyBtYWRlIHdpdGhpbiB0aGUgbGFzdCAgZGF5czpkZAIDDw8WAh8TAaQBZGQCDw9kFggCAQ8PFgIfBgUpU2VhcmNoIGJ5IGludGVydmFsIG9mIGRhdGVzIChkZC1tbS15eXl5KTpkZAIFDw8WAh8TAf4BZGQCCw8PFgIfEwEDAmRkAg8PZBYEAgEPDxYCHwYFJkJ5IGZpbGluZ3MgbWFkZSB3aXRoaW4gdGhlIGxhc3QgIGRheXM6ZGQCAw8PFgIfEwEIAmRkAhUPZBYCAgMPZBYCAgEPD2QWBh8LBWlqYXZhc2NyaXB0OnJldHVybiBXZWJGb3JtX0ZpcmVEZWZhdWx0QnV0dG9uKGV2ZW50LCAnY3RsMDBfQ29udGVudFByaW5jaXBhbF93dWNfRW50aWRhZGVzX2J0blNlbGVjY2lvbmFyJykfCgUGYnV0dG9uHwwFATAWAgIDDxBkZBYAZGR4ZWJ1zCyC459OneBI1C0D36owqA==',
    '__VIEWSTATEGENERATOR': '5CA56416',
    '__EVENTVALIDATION': '/wEdAApv1ql08WFUC5vb4isRF0IZ+ogwTCOsyb2P0NffeU1GxRtGNqsjBPzusbGWxSK7FVNx2T5kTGjYCRc907lRPzgAMIR+fAbycz1HRR3zVMCF2fXsqMjOKWDrx8JbN7ukO+CF1DbpCC8/miCTsBCN6rDuza1OXePEmsDgYVj9chIXtc39qGY3Gzk02ZZ3HKqq7yjxC+eO7YPVMUfMt7y1tRUfruY7WuHjP36/wBH/nZzGkRbojq4=',
    'ctl00$wBusqueda$txtBusqueda': '',
    'ctl00$ContentPrincipal$wNombreEntidad$txtDenominacion': f'{value}',
    'ctl00$ContentPrincipal$wucCodigoLEI$txtCodigoLEI': f'{key}',
    'ctl00$ContentPrincipal$wFechas$fecha_desde': '',
    'ctl00$ContentPrincipal$wFechas$fecha_hasta': '',
    'ctl00$ContentPrincipal$wFechas$ult_dias': '',
    'ctl00$ContentPrincipal$btnOk': 'Search'
    }

    response = requests.post('https://www.cnmv.es/Portal/Consultas/Busqueda.aspx',  params=params, data=data, headers = headers , cookies = cookies )
    soup = BeautifulSoup(response.content, 'html.parser')
    
    cookies = {
        'tipoEnlace': 'enlaceWeb',
        'ASPSESSIONIDSARCQDRR': 'FBMHGNBCNDBLGJHOCLAJDCGC',
        'IdiomaCNMV_': 'AAEAAAD/////AQAAAAAAAAAMAgAAAEFDTk1WLkNvbXVuLCBWZXJzaW9uPTEuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbAUBAAAAGkNOTVYuQ29tdW4uRW50aXRpZXMuSWRpb21hBwAAAAhtX2NvZElTTwdtX29yZGVuDW1faWRpb21hQ29tdW4RbV9sZW5ndWFDb09maWNpYWwIbV9ub21icmURSWRlbnRpZnlEYXRhK21faWQVSWRlbnRpZnlEYXRhK21fbm9tYnJlAQAAAAEAAQgBAQgCAAAABgMAAAACZW4KAAAAAQAGBAAAAAdJbmdsw6lzAgAAAAkEAAAACw==',
    }

    headers = {
        'Connection': 'keep-alive',
        'sec-ch-ua': '"Google Chrome";v="95", "Chromium";v="95", ";Not A Brand";v="99"',
        'sec-ch-ua-mobile': '?0',
        'sec-ch-ua-platform': '"macOS"',
        'Upgrade-Insecure-Requests': '1',
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36',
        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
        'sec-gpc': '1',
        'Sec-Fetch-Site': 'same-origin',
        'Sec-Fetch-Mode': 'navigate',
        'Sec-Fetch-User': '?1',
        'Sec-Fetch-Dest': 'document',
        'Referer': 'https://www.cnmv.es/Portal/consultas/DerechosVoto/PS_AC_INI.aspx?qS={ab60b216-256a-4030-9cd9-c3b07ee0e32b}',
        'Accept-Language': 'es-ES,es;q=0.9,en;q=0.8',
    }


    try:
        for link in soup.find_all('a'):
            text=str(link.get('href'))
            if text[:30]=='Notificaciones-Participaciones':
                params_2 = text

        params = (
            ('qS', params_2[-41:].split('=')[1]),
        )
        response = requests.get('https://www.cnmv.es/Portal/consultas/DerechosVoto/Notificaciones-Participaciones.aspx',  params=params, headers = headers , cookies =cookies)
        soup = BeautifulSoup(response.content, 'html.parser')

        X = 0
        for link in soup.find_all('td'):
            if link.get('headers')==['cabecera21B', 'cabecera21B_6']:
                X = X+ float(link.string)
        
        return X

    except Exception as e:
        print(f'No se ha encontrado la pagina Notificaciones-Participaciones de {value}  ////ERROR DES:{e}////')
    #para 3 activos no consigo que funcione porque el código LEI(como el caso de ARCELORMITTAL) no existe o no concuerda con
    #el nombre de la empresa(el buscador no reconoce el nombre).
    

